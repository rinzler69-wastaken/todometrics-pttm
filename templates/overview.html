{{ define "overview.html" }}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Overview | todometrics</title>
  <script>
    // This script runs immediately to prevent a flash of the light theme.
    (function() {
        try {
        var theme = localStorage.getItem('theme');
        if (!theme) {
            theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }
        document.documentElement.setAttribute('data-theme', theme);
        document.documentElement.setAttribute('data-bs-theme', theme);
        } catch (e) {
        // Silently fail if localStorage is disabled
        }
    })();
    </script>

  <link rel="icon" type="image/svg+xml" href="/static/images/favicon.svg" media="(prefers-color-scheme: light)">
  <link rel="icon" type="image/svg+xml" href="/static/images/favicon-dark.svg" media="(prefers-color-scheme: dark)">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/css/main.css">

</head>
<body data-bs-theme="light">

<nav class="navbar navbar-expand-lg shadow fixed-top gtk-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
        <img src="/static/images/navbrand.svg" alt="todometrics" height="30" class="logo-light">
        <img src="/static/images/navbrand-dark.svg" alt="todometrics" height="30" class="logo-dark">
    </a>
    <div class="d-flex align-items-center ms-auto">
    <div class="d-none d-lg-flex justify-content-end" id="mainNavbar">
      <ul class="navbar-nav">
        <li class="nav-item"><a class="nav-link px-3 rounded-pill me-lg-2 {{ if eq .active "overview" }}bg-purple text-white{{ else }}hover-overview{{ end }}" href="/">Overview</a></li>
        <li class="nav-item"><a class="nav-link px-3 rounded-pill me-lg-2 {{ if eq .active "tasks" }}bg-primary text-white{{ else }}hover-tasks{{ end }}" href="/tasks">Tasks</a></li>
        <li class="nav-item"><a class="nav-link px-3 rounded-pill me-lg-2 {{ if eq .active "completed" }}bg-success text-white{{ else }}hover-completed{{ end }}" href="/completed">Completed Tasks</a></li>
        <li class="nav-item"><a class="nav-link px-3 rounded-pill me-lg-2 {{ if eq .active "about" }}bg-warning text-white{{ else }}hover-about{{ end }}" href="/about">About</a></li>
      </ul>
    </div>

      <button id="theme-toggle" class="btn theme-toggle-btn ms-lg-2">
          <span class="material-icons"></span>
      </button>

  </div>
</nav>

<div class="container">
  <h1 class="text-center mb-4">Tasks Overview</h1>
  <p class="text-muted text-center mb-4">A dashboard of your key task statistics and performance metrics.</p>

  <div class="d-flex flex-wrap justify-content-center align-items-center gap-3 mb-4">
    <button class="btn btn-primary rounded-pill shadow-lg" data-bs-toggle="modal" data-bs-target="#viewOptionsModal">
        <span class="material-symbols-outlined">tune</span>
        Configure View
    </button>
    <span id="viewStatusTag" class="d-flex align-items-center gap-2 border rounded-pill px-3 py-1 shadow-sm view-status-tag">
        <!-- Content will be set by JavaScript -->
    </span>
  </div>

<div id="statBoxGrid" class="row row-cols-2 row-cols-lg-4 g-2 mb-5">
  <!-- Stat boxes will be dynamically generated by JavaScript -->
  <div class="col stat-card-col"><div id="stat-box-0" class="position-relative stat-card shadow-sm"><div class="fw-bold stat-label"></div><div class="stat-number"></div><div class="icon-placeholder"></div></div></div>
  <div class="col stat-card-col"><div id="stat-box-1" class="position-relative stat-card shadow-sm"><div class="fw-bold stat-label"></div><div class="stat-number"></div><div class="icon-placeholder"></div></div></div>
  <div class="col stat-card-col"><div id="stat-box-2" class="position-relative stat-card shadow-sm"><div class="fw-bold stat-label"></div><div class="stat-number"></div><div class="icon-placeholder"></div></div></div>
  <div class="col stat-card-col"><div id="stat-box-3" class="position-relative stat-card shadow-sm"><div class="fw-bold stat-label"></div><div class="stat-number"></div><div class="icon-placeholder"></div></div></div>
</div>

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h5 class="mb-0">Performance Graph</h5>
    <div class="d-flex gap-2">
      <button id="monthlyBtn" class="btn btn-sm rounded-pill btn-success"><span class="material-symbols-outlined">radio_button_checked</span>Monthly</button>
      <button id="yearlyBtn" class="btn btn-sm rounded-pill btn-primary"><span class="material-symbols-outlined">radio_button_unchecked</span>Yearly</button>
    </div>
  </div>

  <div class="graph-pane shadow-sm position-relative">
    <canvas id="performanceChart"></canvas>
    <div id="chartPlaceholder" class="d-none text-center text-muted h-100 d-flex align-items-center justify-content-center">
        <em>No performance data available for this period.<br>Complete some tasks to get started!</em>
    </div>
  </div>

  <div class="mt-3">
    <div class="d-flex justify-content-center align-items-center gap-3 mb-2">
        <span class="d-flex align-items-center small text-muted"><span class="legend-swatch" style="background-color: rebeccapurple;"></span>Exceptional (>1.5)</span>
        <span class="d-flex align-items-center small text-muted"><span class="legend-swatch" style="background-color: #198754;"></span>Good (0.5-1.5)</span>
        <span class="d-flex align-items-center small text-muted"><span class="legend-swatch" style="background-color: #dc3545;"></span>Poor (<0.5)</span>
    </div>
    <p id="chartDescription" class="text-center text-muted small">
        This graph shows your average performance score for each of the last 12 months.
    </p>
  </div>
</div>

<!-- View Options Modal -->
<div class="modal fade" id="viewOptionsModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header"><h5 class="modal-title">Configure Overview</h5><button type="button" class="btn-close adwaita-close" data-bs-dismiss="modal"></button></div>
      <div class="modal-body">
          <h6>Stat Type</h6>
          <div class="d-flex gap-2 mb-3">
              <div class="view-option w-50 shadow-sm active" data-view="ongoing"><strong>Ongoing</strong></div>
              <div class="view-option w-50 shadow-sm" data-view="completed"><strong>Completed</strong></div>
          </div>
          <div id="ongoingSortOptions">
              <h6>Show Ongoing Stats By</h6>
              <div class="d-flex gap-2">
                  <div class="view-option w-50 shadow-sm active" data-sort="urgency"><strong>Urgency</strong></div>
                  <div class="view-option w-50 shadow-sm" data-sort="priority"><strong>Priority</strong></div>
              </div>
          </div>
      </div>
      <div class="modal-footer"><button id="applyViewBtn" type="button" class="btn btn-primary rounded-pill" data-bs-dismiss="modal">Apply View</button></div>
    </div>
  </div>
</div>

<!-- NEW: Mobile Bottom Navbar -->
<nav class="navbar fixed-bottom d-lg-none bottom-navbar">
  <div class="container-fluid h-100">
    <!-- Overview Link -->
    <a href="/" class="bottom-nav-link {{ if eq .active "overview" }}active{{ end }}">
      <span class="material-icons">dashboard</span>
      <span class="bottom-nav-text">Overview</span>
    </a>
    <!-- Tasks Link -->
    <a href="/tasks" class="bottom-nav-link {{ if eq .active "tasks" }}active{{ end }}">
      <span class="material-icons">assignment</span>
      <span class="bottom-nav-text">Tasks</span>
    </a>
    <!-- Completed Link -->
    <a href="/completed" class="bottom-nav-link {{ if eq .active "completed" }}active{{ end }}">
      <span class="material-icons">check_circle</span>
      <span class="bottom-nav-text">Completed</span>
    </a>
    <!-- About Link -->
    <a href="/about" class="bottom-nav-link {{ if eq .active "about" }}active{{ end }}">
      <span class="material-icons">info</span>
      <span class="bottom-nav-text">About</span>
    </a>
  </div>
</nav>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="/static/js/logic.js"></script>

</body>
</html>
{{ end }}
